{
	"name": "Simple RAG",
	"version": "1.0",
	"metadata": {
		"description": "Simple RAG Workflow",
		"type": "RAG"
	},
	"environments": [
		{
			"env_code": "EMB_PATH",
			"env_name": "embedding server url path",
			"env_params": [
				{
					"key": "embedding_server_path",
					"value": "http://127.0.0.1:21434/v1"
				},
				{
					"key": "embed_model_nm",
					"value": "nomic-embed-text:latest"
				}
			]
		},
		{
			"env_code": "VEC_PATH",
			"env_name": "vector db url path",
			"env_params": [
				{
					"key": "vectordb_type",
					"value": "qdrant"
				},
				{
					"key": "vectordb_path",
					"value": "http://127.0.0.1:16333"
				}
			]
		},
		{
			"env_code": "APIKEY",
			"env_name": "api key",
			"env_params": [
				{
					"key": "api-key",
					"value": "12345678890"
				}
			]
		}
	],
	"node_env_maps": [
		{
			"node_id": "Test_1234567890",
			"env_maps": [
				{
					"refer_type": "indirect",
					"key": "embedding_server_path",
					"value": "EMB_PATH.embedding_server_path"
				},
				{
					"refer_type": "indirect",
					"key": "embed_model_nm",
					"value": "EMB_PATH.embed_model_nm"
				},
				{
					"refer_type": "indirect",
					"key": "vectordb_type",
					"value": "VEC_PATH.vectordb_type"
				},
				{
					"refer_type": "indirect",
					"key": "vectordb_path",
					"value": "VEC_PATH.vectordb_path"
				},
				{
					"refer_type": "direct",
					"key": "test_env_key",
					"value": "customized_key"
				}
			]
		},
		{
			"node_id": "Retrieval_724KHk_node",
			"env_maps": [
				{
					"refer_type": "indirect",
					"key": "embedding_server_path",
					"value": "EMB_PATH.embedding_server_path"
				},
				{
					"refer_type": "indirect",
					"key": "embed_model_nm",
					"value": "EMB_PATH.embed_model_nm"
				},
				{
					"refer_type": "indirect",
					"key": "vectordb_type",
					"value": "VEC_PATH.vectordb_type"
				},
				{
					"refer_type": "indirect",
					"key": "vectordb_path",
					"value": "VEC_PATH.vectordb_path"
				},
				{
					"refer_type": "direct",
					"key": "api_key",
					"value": "APIKEY.api-key"
				}
			]
		},
		{
			"node_id": "Generation_TAVl73_node",
			"env_maps": [
				{
					"refer_type": "indirect",
					"key": "api_key",
					"value": "APIKEY.api-key"
				}
			]
		}
	],
	"nodes": [
		{
			"node_id": "Input_zla_r0_node",
			"node_type": "class",
			"role": "start",
			"location": "inner",
			"containable": true,
			"api_keys": [""],

			"node_info": {
				"id": "input_node",
				"code": "RagInput",
				"version": "1.0.0",
				"title": "rag input",
				"desc": "RAG Input Node"
			},
			"api_info": {
				"base_url": ""
			},
			"class_info": {
				"module_path": "app.simple_rag.input.rag_input",
				"class_name": "RagInput",
				"environments": {}
			},
			"services": {
				"query_input": {
					"function": "query_input",
					"params": {
						"format": "json",
						"input": [
							{
								"required": true,
								"key": "query",
								"type": "string"
							}
						]
					},
					"result": {
						"format": "json",
						"output": [
							{
								"key": "query",
								"type": "string"
							}
						]
					}
				}
			}
		},
		{
			"node_id": "Test_1234567890",
			"node_type": "class",
			"role": "start",
			"location": "inner",
			"containable": true,
			"api_keys": [""],

			"node_info": {
				"id": "test_external_node",
				"code": "Ext_API",
				"version": "1.0.0",
				"title": "external_node",
				"desc": "External Connection Node"
			},
			"api_info": {
				"base_url": ""
			},
			"class_info": {
				"module_path": "app.simple_rag.test.test_external_node",
				"class_name": "ExternalRPC",
				"environments": {
					"params": [
						{
							"required": true,
							"key": "embedding_server_path",
							"type": "string"
						},
						{
							"required": true,
							"key": "embed_model_nm",
							"type": "string"
						},
						{
							"required": true,
							"key": "vectordb_type",
							"type": "string"
						},
						{
							"required": true,
							"key": "vectordb_path",
							"type": "string"
						},
						{
							"required": true,
							"key": "test_env_key",
							"type": "string"
						}
					]
				}
			},
			"services": {
				"test_service": {
					"function": "test_service",
					"params": {
						"format": "json",
						"input": [
							{
								"required": true,
								"key": "query",
								"type": "string"
							}
						]
					},
					"result": {
						"format": "json",
						"output": [
							{
								"key": "query",
								"type": "string"
							}
						]
					}
				}
			}
		},
		{
			"node_id": "Retrieval_724KHk_node",
			"node_type": "class",
			"role": "retrieval",
			"location": "inner",
			"containable": true,
			"api_keys": [""],
			"node_info": {
				"id": "Retrieval",
				"code": "RAG_RETR",
				"version": "1.0.0",
				"title": "Retrieval",
				"desc": "RAG Retrieval Node"
			},
			"api_info": {
				"base_url": ""
			},
			"class_info": {
				"module_path": "simple_rag.retrieve.rag_retrieve",
				"class_name": "RagRetrieve",
				"environments": {
					"params": [
						{
							"required": true,
							"key": "embedding_server_path",
							"type": "string"
						},
						{
							"required": true,
							"key": "embed_model_nm",
							"type": "string"
						},
						{
							"required": true,
							"key": "vectordb_type",
							"type": "string"
						},
						{
							"required": true,
							"key": "vectordb_path",
							"type": "string"
						},
						{
							"required": false,
							"key": "api_key",
							"type": "string"
						}
					]
				}
			},
			"services": {
				"retrieve": {
					"function": "retrieve",
					"params": {
						"format": "json",
						"input": [
							{
								"required": true,
								"key": "query",
								"type": "string"
							},
							{
								"required": true,
								"key": "top_k",
								"type": "int",
								"default_value": 0.8
							}
						]
					},
					"header": {},
					"body": {},
					"result": {
						"format": "json",
						"output": [
							{
								"key": "retrieved_documents",
								"type": "object"
							},
							{
								"key": "document_sources",
								"type": "object"
							}
						]
					}
				}
			}
		},
		{
			"node_id": "Generation_TAVl73_node",
			"node_type": "class",
			"role": "generation",
			"location": "inner",
			"containable": true,
			"api_keys": [""],

			"node_info": {
				"id": "Generation",
				"code": "RAG_GEN",
				"version": "1.0.23",
				"title": "Generate Model",
				"desc": "RAG Generation"
			},
			"api_info": {
				"base_url": ""
			},
			"class_info": {
				"module_path": "simple_rag.generate.rag_generate",
				"class_name": "RagGenerator",
				"environments": {
					"params": [
						{
							"required": false,
							"key": "api_key",
							"type": "string"
						}
					]
				}
			},
			"services": {
				"generate_prompt": {
					"function": "generate_prompt",
					"params": {
						"format": "json",
						"input": [
							{
								"required": true,
								"key": "question",
								"type": "string"
							},
							{
								"required": true,
								"key": "prompt_template",
								"type": "object"
							},
							{
								"required": true,
								"key": "retrieved_documents",
								"type": "object"
							}
						]
					},
					"result": {
						"format": "json",
						"output": [
							{
								"key": "prompt",
								"type": "object"
							}
						]
					}
				},
				"generate_answer": {
					"function": "generate_answer",
					"params": {
						"format": "json",
						"input": [
							{
								"required": true,
								"key": "prompt",
								"type": "string"
							},
							{
								"required": true,
								"key": "llm_type",
								"type": "string",
								"default_value": "ollama"
							},
							{
								"required": true,
								"key": "model_name",
								"type": "string",
								"default_valye": "gemma3"
							},
							{
								"required": true,
								"key": "base_url",
								"type": "string",
								"default_value": "http://ailand.ai:30804/v1"
							},
							{
								"required": true,
								"key": "temperature",
								"type": "float",
								"default_value": 0.7
							}
						]
					},
					"result": {
						"format": "json",
						"output": [
							{
								"key": "answer",
								"type": "string"
							}
						]
					}
				}
			}
		},
		{
			"node_id": "Output_OvdARr_node",
			"node_type": "class",
			"role": "output",
			"location": "inner",
			"containable": true,
			"api_keys": [""],

			"node_info": {
				"id": "Output",
				"code": "RAG_OUTPUT",
				"version": "1.0.0",
				"title": "RAG Output",
				"desc": "Rag Output Node"
			},
			"api_info": {
				"base_url": ""
			},
			"class_info": {
				"module_path": "simple_rag.output.rag_output",
				"class_name": "RagOutput",
				"environments": {}
			},
			"services": {
				"output": {
					"function": "output",
					"params": {
						"format": "json",
						"input": [
							{
								"required": true,
								"key": "output_prompt",
								"type": "object"
							},
							{
								"required": true,
								"key": "answer",
								"type": "string"
							}
						]
					},
					"result": {
						"format": "json",
						"output": [
							{
								"required": true,
								"key": "output",
								"type": "json"
							}
						]
					}
				}
			}
		}
	],
	"edges": [
		{
			"source": "Input_zla_r0_node.query_input",
			"source_handler": {
				"type": "sequence",
				"conditions": {}
			},
			"target": "Retrieval_724KHk_node.retrieve",
			"target_handler": {
				"type": "sequence",
				"conditions": {}
			},
			"params_info": [
				{
					"refer_type": "indirect",
					"key": "query",
					"value": "Input_zla_r0_node.query_input.query"
				},
				{
					"refer_type": "direct",
					"key": "top_k",
					"value": 5
				},
				{
					"refer_type": "direct",
					"key": "collection_name",
					"value": "agent"
				},
				{
					"refer_type": "direct",
					"key": "check_embedding_ctx_length",
					"value": false
				}
			]
		},
		{
			"source": "Input_zla_r0_node.query_input",
			"source_handler": {
				"type": "sequence",
				"conditions": {}
			},
			"target": "Test_1234567890.test_service",
			"target_handler": {
				"type": "sequence",
				"conditions": {}
			},
			"params_info": [
				{
					"refer_type": "indirect",
					"key": "query",
					"value": "Input_zla_r0_node.query_input.query"
				}
			]
		},
		{
			"source": "Retrieval_724KHk_node.retrieve",
			"source_handler": {
				"type": "sequence",
				"conditions": {}
			},
			"target": "Generation_TAVl73_node.generate_prompt",
			"target_handler": {
				"type": "sequence",
				"conditions": {}
			},
			"params_info": [
				{
					"refer_type": "indirect",
					"key": "question",
					"value": "Input_zla_r0_node.query_input.query"
				},
				{
					"refer_type": "direct",
					"key": "prompt_template",
					"value": "\"다음 Context를 참고하여 질문에 한국어로 답하세요 \\n 질문 : {{question}} \\n Context : {{docs | join('\\n')}}\""
				},
				{
					"refer_type": "indirect",
					"key": "retrieved_documents",
					"value": "Retrieval_724KHk_node.retrieve.retrieved_documents"
				}
			]
		},
		{
			"source": "Generation_TAVl73_node.generate_prompt",
			"source_handler": {
				"type": "sequence",
				"conditions": {}
			},
			"target": "Generation_TAVl73_node.generate_answer",
			"target_handler": {
				"type": "sequence",
				"conditions": {}
			},
			"params_info": [
				{
					"refer_type": "indirect",
					"key": "prompt",
					"value": "Generation_TAVl73_node.generate_prompt.prompt"
				},
				{
					"refer_type": "direct",
					"key": "llm_type",
					"value": "openai"
				},
				{
					"refer_type": "direct",
					"key": "model_name",
					"value": "gemma3:12b"
				},
				{
					"refer_type": "direct",
					"key": "base_url",
					"value": "http://192.15.90.108:21434/v1"
				},
				{
					"refer_type": "direct",
					"key": "temperature",
					"value": 0.5
				}
			]
		},
		{
			"source": "Generation_TAVl73_node.generate_answer",
			"source_handler": {
				"type": "sequence",
				"conditions": {}
			},
			"target": "Output_OvdARr_node.output",
			"target_handler": {
				"type": "sequence",
				"conditions": {}
			},
			"env_info": [

			],
			"params_info": [
				{
					"refer_type": "direct",
					"key": "output_prompt",
					"value": "{{answer}}"
				},
				{
					"refer_type": "indirect",
					"key": "answer",
					"value": "Generation_TAVl73_node.generate_answer.answer"
				}
			],
			"result_info": [
				{
					"refer_type": "direct",
					"key": "output_prompt",
					"value": "Generation_TAVl73_node.generate_answer.answer"
				}
			]
		}
	],
	"resources": {
		"node_a": {
		}
	}
}
